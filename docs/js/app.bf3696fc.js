(function(e){function n(n){for(var o,d,r=n[0],c=n[1],s=n[2],l=0,w=[];l<r.length;l++)d=r[l],Object.prototype.hasOwnProperty.call(a,d)&&a[d]&&w.push(a[d][0]),a[d]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);u&&u(n);while(w.length)w.shift()();return i.push.apply(i,s||[]),t()}function t(){for(var e,n=0;n<i.length;n++){for(var t=i[n],o=!0,r=1;r<t.length;r++){var c=t[r];0!==a[c]&&(o=!1)}o&&(i.splice(n--,1),e=d(d.s=t[0]))}return e}var o={},a={app:0},i=[];function d(n){if(o[n])return o[n].exports;var t=o[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,d),t.l=!0,t.exports}d.m=e,d.c=o,d.d=function(e,n,t){d.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},d.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},d.t=function(e,n){if(1&n&&(e=d(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(d.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)d.d(t,o,function(n){return e[n]}.bind(null,o));return t},d.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return d.d(n,"a",n),n},d.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},d.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=n,r=r.slice();for(var s=0;s<r.length;s++)n(r[s]);var u=c;i.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"56d7":function(e,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d");var o=t("7a23"),a=t("ecdb"),i=t.n(a),d={class:"btn-group options"},r=Object(o["d"])("label",{class:"btn btn-outline-primary",for:"btncheck1"},"Model",-1),c=Object(o["d"])("label",{class:"btn btn-outline-primary",for:"btncheck2"},"Debug",-1),s=Object(o["d"])("a",{href:"https://github.com/ClarkThyLord/Vox-Face"},[Object(o["d"])("img",{src:i.a,alt:"Vox-Face",class:"vf-icon"})],-1),u=Object(o["d"])("video",{id:"cameraVideo"},null,-1),l=Object(o["d"])("canvas",{id:"threeCanvas"},null,-1);function w(e,n,t,a,i,w){var h=Object(o["i"])("About");return Object(o["h"])(),Object(o["c"])(o["a"],null,[Object(o["d"])("div",d,[Object(o["k"])(Object(o["d"])("input",{"onUpdate:modelValue":n[0]||(n[0]=function(e){return w.showModel=e}),type:"checkbox",class:"btn-check",id:"btncheck1"},null,512),[[o["j"],w.showModel]]),r,Object(o["k"])(Object(o["d"])("input",{"onUpdate:modelValue":n[1]||(n[1]=function(e){return w.debugMode=e}),type:"checkbox",class:"btn-check",id:"btncheck2"},null,512),[[o["j"],w.debugMode]]),c,Object(o["d"])("button",{onClick:n[2]||(n[2]=function(){return w.showAbout&&w.showAbout.apply(w,arguments)}),type:"button",class:"btn btn-outline-secondary"}," About ")]),s,Object(o["f"])(h,{ref:"about"},null,512),Object(o["d"])("main",null,[u,l,Object(o["d"])("canvas",{class:Object(o["g"])({"d-none":!w.debugMode}),id:"humanCanvas"},null,2),Object(o["d"])("canvas",{class:Object(o["g"])({"d-none":!w.debugMode}),id:"segmentationCanvas"},null,2)])],64)}var h=t("1da1"),b=(t("96cf"),t("d3b7"),{class:"modal fade",tabindex:"-1",id:"About"}),m=Object(o["e"])('<div class="modal-dialog"><div class="modal-content"><div class="modal-body"><img src="vox-face.svg" alt="" class="rounded mx-auto d-block"><h2 class="text-center">Vox-Face</h2><p class="fst-normal text-center"> AR web app for making voxel faces </p><p class="text-center"><a href="https://github.com/ClarkThyLord/Vox-Face" class="text-decoration-none"> GitHub </a></p></div><div class="modal-footer"><div class="d-grid gap-2 col-6 mx-auto"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal"> Close </button></div></div></div></div>',1),f=[m];function v(e,n,t,a,i,d){return Object(o["h"])(),Object(o["c"])("div",b,f)}var p={name:"About",data:function(){return{_modal:void 0}},mounted:function(){this._modal=new window.Bootstrap.Modal(document.getElementById("About"))},methods:{show:function(){this._modal&&this._modal.show()},hide:function(){this._modal&&this._modal.hide()}}},g=t("6b0d"),x=t.n(g);const y=x()(p,[["render",v]]);var j=y,O=t("361b"),C=t("5a89"),M=t("b85c"),k=t("d4ec"),F=t("bee2"),_=t("262e"),V=t("2caf"),A=(t("cfc3"),t("9a8c"),t("a975"),t("735e"),t("c1ac"),t("d139"),t("3a7b"),t("d5d6"),t("82f8"),t("e91f"),t("60bd"),t("5f96"),t("3280"),t("3fcc"),t("ca91"),t("25a1"),t("cd26"),t("3c5d"),t("2954"),t("649e"),t("219c"),t("170b"),t("b39a"),t("72f7"),function(e){Object(_["a"])(t,e);var n=Object(V["a"])(t);function t(e){var o;return Object(k["a"])(this,t),o=n.call(this),o.positions=new Float32Array(1434),o.setAttribute("position",new C["b"](o.positions,3)),o.setIndex(e),o}return Object(F["a"])(t,[{key:"update",value:function(e,n,t){var o,a=0,i=Object(M["a"])(t.mesh);try{for(i.s();!(o=i.n()).done;){var d=o.value;this.positions[a+0]=-d[0]+e/2,this.positions[a+1]=n-d[1]-n/2,this.positions[a+2]=-d[2],a+=3}}catch(r){i.e(r)}finally{i.f()}this.attributes.position.needsUpdate=!0,this.computeVertexNormals()}}]),t}(C["c"]));window.human=new O["a"]({backend:"webgl",modelBasePath:"models/",face:{enabled:!0,detector:{rotation:!0,maxDetected:1},mesh:{enabled:!0},iris:{enabled:!0},description:{enabled:!1},emotion:{enabled:!1}},hand:{enabled:!1},body:{enabled:!1},object:{enabled:!1},filter:{enabled:!1},gesture:{enabled:!1}});var S={name:"App",components:{About:j},data:function(){return{_showModel:"false"!==window.Cookies.get("showModel"),_debugMode:"false"!==window.Cookies.get("debugMode")}},computed:{showModel:{get:function(){return this.$data._showModel},set:function(e){Cookies.set("showModel",e),this.$data._showModel=e}},debugMode:{get:function(){return this.$data._debugMode},set:function(e){Cookies.set("debugMode",e),this.$data._debugMode=e}}},methods:{showAbout:function(){this.$refs.about.show()},hideAbout:function(){this.$refs.about.hide()}},mounted:function(){var e=this;void 0===window.Cookies.get("seenAbout")&&(this.showAbout(),Cookies.set("seenAbout",!0,{expires:7})),window.threeCanvas=document.getElementById("threeCanvas"),window.humanCanvas=document.getElementById("humanCanvas"),window.segmentationCanvas=document.getElementById("segmentationCanvas"),window.segmentationContext=window.segmentationCanvas.getContext("2d"),window.threeRenderer=new C["h"]({antialias:!0,alpha:!0,canvas:window.threeCanvas}),window.threeRenderer.outputEncoding=C["i"],window.threeCamera=new C["f"],window.threeCamera.near=-1e3,window.threeCamera.far=1e3,window.threeScene=new C["g"];var n=new C["d"](new A(human.faceTriangulation),new C["e"]({color:16755370,wireframe:!0}));n.visible=!1,window.threeScene.add(n),window.voxFaceMesh=new C["d"](new C["a"](1,1,1),new C["e"]),window.voxFaceMesh.visible=!1,window.threeScene.add(window.voxFaceMesh);var t=function(e){return e.srcObject&&"live"===e.srcObject.getVideoTracks()[0].readyState&&e.readyState>2&&!e.paused},o=function(){window.threeCamera.left=-window.innerWidth/2,window.threeCamera.right=window.innerWidth/2,window.threeCamera.top=window.innerHeight/2,window.threeCamera.bottom=-window.innerHeight/2,window.threeCamera.aspect=window.innerWidth/window.innerHeight,window.threeCamera.updateProjectionMatrix(),window.threeRenderer.setSize(window.innerWidth,window.innerHeight)};Object(h["a"])(regeneratorRuntime.mark((function a(){var i,d,r,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return window.addEventListener("unhandledrejection",(function(e){console.error(e.reason||e),e.preventDefault()})),a.next=3,human.load();case 3:if(navigator.mediaDevices){a.next=5;break}return a.abrupt("return",null);case 5:return window.cameraVideo=document.getElementById("cameraVideo"),window.threeCanvas.addEventListener("click",(function(){t(window.cameraVideo)?window.cameraVideo.pause():window.cameraVideo.play()})),i={audio:!1,video:{facingMode:"user",resizeMode:"crop-and-scale",width:{ideal:1920},aspectRatio:1920/1080}},a.next=10,navigator.mediaDevices.getUserMedia(i);case 10:if(d=a.sent,!d){a.next=15;break}window.cameraVideo.srcObject=d,a.next=16;break;case 15:return a.abrupt("return",null);case 16:return a.next=18,new Promise((function(e){window.cameraVideo.onloadeddata=Object(h["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:window.cameraVideo.play(),e(window.cameraVideo);case 2:case"end":return n.stop()}}),n)})))}));case 18:r=a.sent,r&&(o(),window.addEventListener("resize",o),c=function(){var o=Object(h["a"])(regeneratorRuntime.mark((function o(a){var i,d,r,s,u,l,w,h,b,m,f,v,p,g,x,y,j,O,C,M,k,F,_;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(i=!1,!t(a)){o.next=6;break}return o.next=4,human.detect(a);case 4:if(r=o.sent,(null===r||void 0===r||null===(d=r.face)||void 0===d?void 0:d.length)>0){if(human.next(r),m=r.face[0],n.geometry.update(a.videoWidth,a.videoHeight,m),n.geometry.computeBoundingBox(),n.geometry.boundingBox.getCenter(window.voxFaceMesh.position),window.voxFaceMesh.rotation.set((null===(s=m.rotation)||void 0===s||null===(u=s.angle)||void 0===u?void 0:u.pitch)||0,(null===(l=m.rotation)||void 0===l||null===(w=l.angle)||void 0===w?void 0:w.yaw)||0,(null===(h=m.rotation)||void 0===h||null===(b=h.angle)||void 0===b?void 0:b.roll)||0,"XYZ"),n.geometry.boundingBox.getSize(window.voxFaceMesh.scale),window.voxFaceMesh.scale.y*=1.25,window.voxFaceMesh.scale.x=window.voxFaceMesh.scale.y,window.voxFaceMesh.scale.z=window.voxFaceMesh.scale.y,m.box[2]>0&&m.box[3]>0){for(window.segmentationCanvas.width=m.box[2],window.segmentationCanvas.height=m.box[3],window.segmentationContext.drawImage(cameraVideo,m.box[0],m.box[1],m.box[2],m.box[3],0,0,window.segmentationCanvas.width,window.segmentationCanvas.height),f=window.segmentationContext.getImageData(0,0,window.segmentationCanvas.width,window.segmentationCanvas.height),v=0,p=0,g=0,x=0;x<f.data.length;x+=4)y=f.data[x],j=f.data[x+1],O=f.data[x+2],f.data[x+3],C=128,M=.299*y+.587*j+.114*O,k=.713*(y-M)+C,F=.564*(O-M)+C,M>=0&&M<=235&&k>=133&&k<=173&&F>=77&&F<=127&&(v+=y,p+=j,g+=O,f.data[x]=255,f.data[x+1]=0,f.data[x+2]=0);v/=f.data.length/4,p/=f.data.length/4,g/=f.data.length/4,_="rgb("+Math.round(v)+", "+Math.round(p)+", "+Math.round(g)+")",window.voxFaceMesh.material.color.set(_),window.segmentationContext.putImageData(f,0,0)}e.debugMode&&(window.humanCanvas.width=a.videoWidth,window.humanCanvas.height=a.videoHeight,human.draw.face(window.humanCanvas,r.face)),i=!0}case 6:window.voxFaceMesh.visible=i&&e.showModel,window.threeRenderer.render(window.threeScene,window.threeCamera),requestAnimationFrame((function(){return c(a)}));case 9:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}(),c(r));case 20:case"end":return a.stop()}}),a)})))()}};t("e6c6");const B=x()(S,[["render",w]]);var R=B,E=(t("ab8b"),t("7b17")),P=t("852e"),D=t.n(P);window.Bootstrap=E,window.Cookies=D.a,Object(o["b"])(R).mount("#app")},"75fc":function(e,n){function t(e){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}t.keys=function(){return[]},t.resolve=t,e.exports=t,t.id="75fc"},de07:function(e,n,t){},e6c6:function(e,n,t){"use strict";t("de07")},ecdb:function(e,n,t){e.exports=t.p+"img/vox-face.ad9fcde5.svg"}});
//# sourceMappingURL=app.bf3696fc.js.map