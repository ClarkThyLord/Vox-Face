(function(e){function t(t){for(var o,d,r=t[0],s=t[1],c=t[2],w=0,l=[];w<r.length;w++)d=r[w],Object.prototype.hasOwnProperty.call(a,d)&&a[d]&&l.push(a[d][0]),a[d]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);u&&u(t);while(l.length)l.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,r=1;r<n.length;r++){var s=n[r];0!==a[s]&&(o=!1)}o&&(i.splice(t--,1),e=d(d.s=n[0]))}return e}var o={},a={app:0},i=[];function d(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,d),n.l=!0,n.exports}d.m=e,d.c=o,d.d=function(e,t,n){d.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},d.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},d.t=function(e,t){if(1&t&&(e=d(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(d.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)d.d(n,o,function(t){return e[t]}.bind(null,o));return n},d.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return d.d(t,"a",t),t},d.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},d.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],s=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var u=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"34e6":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23"),a=n("ecdb"),i=n.n(a),d={class:"btn-group options"},r=Object(o["e"])("label",{class:"btn btn-outline-primary",for:"btncheck1"},"Model",-1),s=Object(o["e"])("label",{class:"btn btn-outline-primary",for:"btncheck2"},"Debug",-1),c=Object(o["e"])("a",{href:"https://github.com/ClarkThyLord/Vox-Face"},[Object(o["e"])("img",{src:i.a,alt:"Vox-Face",class:"vf-icon"})],-1),u=Object(o["e"])("video",{id:"cameraVideo"},null,-1),w=Object(o["e"])("canvas",{id:"threeCanvas"},null,-1);function l(e,t,n,a,i,l){var b=Object(o["i"])("About");return Object(o["h"])(),Object(o["d"])(o["a"],null,[Object(o["e"])("div",d,[Object(o["k"])(Object(o["e"])("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return l.showModel=e}),type:"checkbox",class:"btn-check",id:"btncheck1"},null,512),[[o["j"],l.showModel]]),r,Object(o["k"])(Object(o["e"])("input",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.debugMode=e}),type:"checkbox",class:"btn-check",id:"btncheck2"},null,512),[[o["j"],l.debugMode]]),s,Object(o["e"])("button",{onClick:t[2]||(t[2]=function(){return l.showAbout&&l.showAbout.apply(l,arguments)}),type:"button",class:"btn btn-outline-secondary"}," About ")]),c,Object(o["f"])(b,{ref:"about"},null,512),Object(o["e"])("main",null,[u,w,Object(o["e"])("canvas",{class:Object(o["g"])({"d-none":!l.debugMode}),id:"humanCanvas"},null,2),Object(o["e"])("canvas",{class:Object(o["g"])({"d-none":!l.debugMode}),id:"segmentationCanvas"},null,2)])],64)}var b=n("1da1"),h=(n("96cf"),n("d3b7"),{class:"modal fade",tabindex:"-1",id:"About"}),p={class:"modal-dialog"},m={class:"modal-content"},g={class:"modal-body"},f=Object(o["e"])("h2",{class:"text-center"},"Vox-Face",-1),v=Object(o["e"])("p",{class:"fst-normal text-center"}," AR web app for making voxel faces ",-1),O=Object(o["e"])("p",{class:"text-center"},[Object(o["e"])("a",{href:"https://github.com/ClarkThyLord/Vox-Face",class:"text-decoration-none"}," GitHub ")],-1),j={key:0,class:"container debugOptions"},x={class:"row row-cols-2 justify-content-center mx-5"},y={class:"form-check form-switch"},k=Object(o["e"])("label",{class:"form-check-label",for:"drawBoxes"}," Draw Boxes ",-1),C={class:"form-check form-switch"},M=Object(o["e"])("label",{class:"form-check-label",for:"drawPoints"}," Draw Points ",-1),D={class:"form-check form-switch"},P=Object(o["e"])("label",{class:"form-check-label",for:"drawPolygons"}," Draw Polygons ",-1),V={class:"form-check form-switch"},_=Object(o["e"])("label",{class:"form-check-label",for:"drawGaze"}," Draw Gaze ",-1),S={class:"form-check form-switch"},B=Object(o["e"])("label",{class:"form-check-label",for:"drawSegmentation"}," Draw Segmentation ",-1),F=Object(o["e"])("div",{class:"modal-footer"},[Object(o["e"])("div",{class:"d-grid gap-2 col-6 mx-auto"},[Object(o["e"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")])],-1);function A(e,t,n,a,i,d){return Object(o["h"])(),Object(o["d"])("div",h,[Object(o["e"])("div",p,[Object(o["e"])("div",m,[Object(o["e"])("div",g,[Object(o["e"])("img",{onDblclick:t[0]||(t[0]=function(e){return d.showDebugOptions=!d.showDebugOptions}),src:"vox-face.svg",alt:"",class:"rounded mx-auto d-block"},null,32),f,v,O,d.showDebugOptions?(Object(o["h"])(),Object(o["d"])("div",j,[Object(o["e"])("div",x,[Object(o["e"])("div",y,[Object(o["k"])(Object(o["e"])("input",{type:"checkbox",role:"switch","onUpdate:modelValue":t[1]||(t[1]=function(e){return i.debugOptions.drawBoxes=e}),class:"form-check-input",id:"drawBoxes"},null,512),[[o["j"],i.debugOptions.drawBoxes]]),k]),Object(o["e"])("div",C,[Object(o["k"])(Object(o["e"])("input",{type:"checkbox",role:"switch","onUpdate:modelValue":t[2]||(t[2]=function(e){return i.debugOptions.drawPoints=e}),class:"form-check-input",id:"drawPoints"},null,512),[[o["j"],i.debugOptions.drawPoints]]),M]),Object(o["e"])("div",D,[Object(o["k"])(Object(o["e"])("input",{type:"checkbox",role:"switch","onUpdate:modelValue":t[3]||(t[3]=function(e){return i.debugOptions.drawPolygons=e}),class:"form-check-input",id:"drawPolygons"},null,512),[[o["j"],i.debugOptions.drawPolygons]]),P]),Object(o["e"])("div",V,[Object(o["k"])(Object(o["e"])("input",{type:"checkbox",role:"switch","onUpdate:modelValue":t[4]||(t[4]=function(e){return i.debugOptions.drawGaze=e}),class:"form-check-input",id:"drawGaze"},null,512),[[o["j"],i.debugOptions.drawGaze]]),_]),Object(o["e"])("div",S,[Object(o["k"])(Object(o["e"])("input",{type:"checkbox",role:"switch","onUpdate:modelValue":t[5]||(t[5]=function(e){return i.debugOptions.drawSegmentation=e}),class:"form-check-input",id:"drawSegmentation"},null,512),[[o["j"],i.debugOptions.drawSegmentation]]),B])])])):Object(o["c"])("",!0)]),F])])])}var z={name:"About",data:function(){return{_modal:void 0,_showDebugOptions:"true"===window.Cookies.get("showDebugOptions"),debugOptions:window.debugOptions}},computed:{showDebugOptions:{get:function(){return this.$data._showDebugOptions},set:function(e){Cookies.set("showDebugOptions",e),this.$data._showDebugOptions=e}}},mounted:function(){this._modal=new window.Bootstrap.Modal(document.getElementById("About"))},methods:{show:function(){this._modal&&this._modal.show()},hide:function(){this._modal&&this._modal.hide()}}},R=n("6b0d"),E=n.n(R);const U=E()(z,[["render",A]]);var G=U,I=n("361b"),$=n("5a89"),H=n("b85c"),T=n("d4ec"),L=n("bee2"),W=n("262e"),N=n("2caf"),J=(n("cfc3"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),function(e){Object(W["a"])(n,e);var t=Object(N["a"])(n);function n(e){var o;return Object(T["a"])(this,n),o=t.call(this),o.positions=new Float32Array(1434),o.setAttribute("position",new $["b"](o.positions,3)),o.setIndex(e),o}return Object(L["a"])(n,[{key:"update",value:function(e,t,n){var o,a=0,i=Object(H["a"])(n.mesh);try{for(i.s();!(o=i.n()).done;){var d=o.value;this.positions[a+0]=-d[0]+e/2,this.positions[a+1]=t-d[1]-t/2,this.positions[a+2]=-d[2],a+=3}}catch(r){i.e(r)}finally{i.f()}this.attributes.position.needsUpdate=!0,this.computeVertexNormals()}}]),n}($["c"]));window.human=new I["a"]({backend:"webgl",modelBasePath:"models/",face:{enabled:!0,detector:{rotation:!0,maxDetected:1},mesh:{enabled:!0},iris:{enabled:!0},description:{enabled:!1},emotion:{enabled:!1}},hand:{enabled:!1},body:{enabled:!1},object:{enabled:!1},filter:{enabled:!1},gesture:{enabled:!1}});var q={name:"App",components:{About:G},data:function(){return{_showModel:"false"!==window.Cookies.get("showModel"),_debugMode:"true"===window.Cookies.get("debugMode")}},computed:{showModel:{get:function(){return this.$data._showModel},set:function(e){Cookies.set("showModel",e),this.$data._showModel=e}},debugMode:{get:function(){return this.$data._debugMode},set:function(e){Cookies.set("debugMode",e),this.$data._debugMode=e}}},methods:{showAbout:function(){this.$refs.about.show()},hideAbout:function(){this.$refs.about.hide()}},mounted:function(){var e=this;void 0===window.Cookies.get("seenAbout")&&(this.showAbout(),Cookies.set("seenAbout",!0,{expires:7})),window.threeCanvas=document.getElementById("threeCanvas"),window.humanCanvas=document.getElementById("humanCanvas"),window.segmentationCanvas=document.getElementById("segmentationCanvas"),window.segmentationContext=window.segmentationCanvas.getContext("2d"),window.threeRenderer=new $["h"]({antialias:!0,alpha:!0,canvas:window.threeCanvas}),window.threeRenderer.outputEncoding=$["i"],window.threeCamera=new $["f"],window.threeCamera.near=-1e3,window.threeCamera.far=1e3,window.threeScene=new $["g"];var t=new $["d"](new J(human.faceTriangulation),new $["e"]({color:16755370,wireframe:!0}));t.visible=!1,window.threeScene.add(t),window.voxFaceMesh=new $["d"](new $["a"](1,1,1),new $["e"]),window.voxFaceMesh.visible=!1,window.threeScene.add(window.voxFaceMesh);var n=function(e){return e.srcObject&&"live"===e.srcObject.getVideoTracks()[0].readyState&&e.readyState>2&&!e.paused},o=function(){window.threeCamera.left=-window.innerWidth/2,window.threeCamera.right=window.innerWidth/2,window.threeCamera.top=window.innerHeight/2,window.threeCamera.bottom=-window.innerHeight/2,window.threeCamera.aspect=window.innerWidth/window.innerHeight,window.threeCamera.updateProjectionMatrix(),window.threeRenderer.setSize(window.innerWidth,window.innerHeight)};Object(b["a"])(regeneratorRuntime.mark((function a(){var i,d,r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return window.addEventListener("unhandledrejection",(function(e){console.error(e.reason||e),e.preventDefault()})),a.next=3,human.load();case 3:if(navigator.mediaDevices){a.next=5;break}return a.abrupt("return",null);case 5:return window.cameraVideo=document.getElementById("cameraVideo"),window.threeCanvas.addEventListener("click",(function(){n(window.cameraVideo)?window.cameraVideo.pause():window.cameraVideo.play()})),i={audio:!1,video:{facingMode:"user",resizeMode:"crop-and-scale",width:{ideal:1920},aspectRatio:1920/1080}},a.next=10,navigator.mediaDevices.getUserMedia(i);case 10:if(d=a.sent,!d){a.next=15;break}window.cameraVideo.srcObject=d,a.next=16;break;case 15:return a.abrupt("return",null);case 16:return a.next=18,new Promise((function(e){window.cameraVideo.onloadeddata=Object(b["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:window.cameraVideo.play(),e(window.cameraVideo);case 2:case"end":return t.stop()}}),t)})))}));case 18:r=a.sent,r&&(o(),window.addEventListener("resize",o),s=function(){var o=Object(b["a"])(regeneratorRuntime.mark((function o(a){var i,d,r,c,u,w,l,b,h,p,m,g,f,v,O,j,x,y,k,C,M,D,P;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(i=!1,!n(a)){o.next=6;break}return o.next=4,human.detect(a);case 4:if(r=o.sent,(null===r||void 0===r||null===(d=r.face)||void 0===d?void 0:d.length)>0){if(human.next(r),p=r.face[0],t.geometry.update(a.videoWidth,a.videoHeight,p),t.geometry.computeBoundingBox(),t.geometry.boundingBox.getCenter(window.voxFaceMesh.position),window.voxFaceMesh.rotation.set((null===(c=p.rotation)||void 0===c||null===(u=c.angle)||void 0===u?void 0:u.pitch)||0,(null===(w=p.rotation)||void 0===w||null===(l=w.angle)||void 0===l?void 0:l.yaw)||0,(null===(b=p.rotation)||void 0===b||null===(h=b.angle)||void 0===h?void 0:h.roll)||0,"XYZ"),t.geometry.boundingBox.getSize(window.voxFaceMesh.scale),window.voxFaceMesh.scale.y*=1.25,window.voxFaceMesh.scale.x=window.voxFaceMesh.scale.y,window.voxFaceMesh.scale.z=window.voxFaceMesh.scale.y,p.box[2]>0&&p.box[3]>0){for(window.segmentationCanvas.width=p.box[2],window.segmentationCanvas.height=p.box[3],window.segmentationContext.drawImage(cameraVideo,p.box[0],p.box[1],p.box[2],p.box[3],0,0,window.segmentationCanvas.width,window.segmentationCanvas.height),m=window.segmentationContext.getImageData(0,0,window.segmentationCanvas.width,window.segmentationCanvas.height),g=0,f=0,v=0,O=0;O<m.data.length;O+=4)j=m.data[O],x=m.data[O+1],y=m.data[O+2],m.data[O+3],k=128,C=.299*j+.587*x+.114*y,M=.713*(j-C)+k,D=.564*(y-C)+k,C>=0&&C<=235&&M>=133&&M<=173&&D>=77&&D<=127&&(g+=j,f+=x,v+=y,m.data[O]=255,m.data[O+1]=0,m.data[O+2]=0);g/=m.data.length/4,f/=m.data.length/4,v/=m.data.length/4,P="rgb("+Math.round(g)+", "+Math.round(f)+", "+Math.round(v)+")",window.voxFaceMesh.material.color.set(P),window.segmentationContext.putImageData(m,0,0)}e.debugMode&&(window.human.draw.options.drawBoxes=window.debugOptions.drawBoxes,window.human.draw.options.drawPoints=window.debugOptions.drawPoints,window.human.draw.options.drawPolygons=window.debugOptions.drawPolygons,window.human.draw.options.drawGaze=window.debugOptions.drawGaze,window.segmentationCanvas.style.display=window.debugOptions.drawSegmentation?"block":"none",window.humanCanvas.width=a.videoWidth,window.humanCanvas.height=a.videoHeight,human.draw.face(window.humanCanvas,r.face)),i=!0}case 6:window.voxFaceMesh.visible=i&&e.showModel,window.threeRenderer.render(window.threeScene,window.threeCamera),requestAnimationFrame((function(){return s(a)}));case 9:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}(),s(r));case 20:case"end":return a.stop()}}),a)})))()}};n("fa7f");const X=E()(q,[["render",l]]);var Y=X,Z=(n("ab8b"),n("7b17")),K=n("852e"),Q=n.n(K);window.Bootstrap=Z,window.Cookies=Q.a,window.saveDebugOptions=function(){Q.a.set("debugOptions",JSON.stringify(window.debugOptions))},window.resetDebugOptions=function(){window.debugOptions={drawBoxes:!0,drawPoints:!1,drawPolygons:!1,drawGaze:!1,drawSegmentation:!0}},window.loadDebugOptions=function(){window.debugOptions=window.Cookies.get("debugOptions"),void 0===window.debugOptions?window.resetDebugOptions():window.debugOptions=JSON.parse(window.debugOptions)},loadDebugOptions(),Object(o["b"])(Y).mount("#app")},"75fc":function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="75fc"},ecdb:function(e,t,n){e.exports=n.p+"img/vox-face.ad9fcde5.svg"},fa7f:function(e,t,n){"use strict";n("34e6")}});
//# sourceMappingURL=app.2bcd668b.js.map